
{% extends 'base.html' %}

{% block additionalhead %}
  {# Specific for this page #}
  <script src="{{ url_for('static', filename='js/event/edit.js') }}"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/event/edit.css') }}">

  {# DateTime picker#}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/tail.datetime-harx-light.min.css') }}">
  <script src="{{ url_for('static', filename='js/tail.datetime-full.min.js') }}"></script>

  {# Wysiwyg Editor #}
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
  <script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
{% endblock %}

{% block header %}
  <h1>{% block title %}Rédaction d'activité{% endblock %}</h1>
{% endblock %}

{% block content %}
<div class="panel" id="eventedit">
  <!-- Logging Windows -->
  <h3>Rédaction d'activité</h3>
  <form
        action="{{ action }}"
        method="POST"
        onsubmit="document.querySelector('textarea[name=description]').value=simplemde.value()"
        enctype="multipart/form-data"
  >
    <h4>Informations</h4>
     <label for="title">Titre : </label> {{ form.title(size=200) }}<br/>
     <label for="type">Type : </label> {{ form.type }}<br/>
     <label for="status">État : </label> {{ form.status }}<br/>
     <label for="num_slots">Nombre de participants : </label> {{ form.num_slots(size=4) }}<br/>

    <div class="dates">
      <h4>Dates</h4>
      <span class="datetimepicker" id="datetimepickerstart"><label for="start" onchange="copyStartDate();">Date et heure de rendez-vous : </label>{{ form.start(onchange="copyStartDate()")}}</span>
      <span class="datetimepicker" id="datetimepickerend"><label for="end" >Date de fin : </label>{{ form.end }}</span>
    </div>

    <div class="dates">
      <h4>Inscriptions par internet</h4>
      <label for="num_online_slots">Nombre de participants internet : </label> {{ form.num_online_slots(size=4) }}<br/>
      <span class="datetimepicker" id="datetimepicker_open"><label for="registration_open_time" >Ouverture des inscriptions : </label>{{ form.registration_open_time}}</span>
      <span class="datetimepicker" id="datetimepicker_close" ><label for="registration_close_time" >Fermeture des inscriptions : </label>{{ form.registration_close_time }}</span>
    </div>

    <h4>Description</h4>
    <div id="editor"><textarea id="editor-area"></textarea></div>
    {{ form.description(style="display:none;", required=false) }}<br/>
    <label for="photo_file">Image de présentation : <br/>&#9432; Max 2MB. Photo uniquement </label> {{ form.photo_file }} <br/>
    <br/>
    {{ form.hidden_tag() }}
     <br/><input type="submit" value="Enregistrer"  />
  </form>
</div>
<script>
tail.DateTime("input[type=datetime]",{
    weekStart: 1
});

var simplemde = new SimpleMDE({ 
  element: document.getElementById("editor-area"),
  blockStyles: {italic:"_"},
  spellChecker:false,
  status:false,
  promptURLs:true,
  toolbar: [
    {
			name: "bold",
			action: SimpleMDE.toggleBold,
			className: "fa fa-bold",
			title: "Gras",
		},
    {
			name: "italic",
			action: SimpleMDE.toggleItalic,
			className: "fa fa-italic",
			title: "Italique",
		},
    {
			name: "strikethrough",
			action: SimpleMDE.toggleStrikethrough,
			className: "fa fa-strikethrough",
			title: "Barré",
		},
    {
			name: "heading",
			action: SimpleMDE.toggleHeadingSmaller,
			className: "fa fa-header",
			title: "Titre",
		},
    "|",
    {
			name: "list-ul",
			action: SimpleMDE.toggleUnorderedList,
			className: "fa fa-list-ul",
			title: "Liste",
		},
    {
			name: "list-ol",
			action: SimpleMDE.toggleOrderedList,
			className: "fa fa-list-ol",
			title: "Liste numérotée",
		},
    "|",
    {
			name: "link",
			action: SimpleMDE.drawLink,
			className: "fa fa-link",
			title: "Lien hypertexte",
		},
    {
			name: "image",
			action: SimpleMDE.drawImage,
			className: "fa fa-picture-o",
			title: "Image",
		},
    {
			name: "table",
			action: SimpleMDE.drawTable,
			className: "fa fa-table",
			title: "Tableau",
		},
    "|",
    {
			name: "preview",
			action: SimpleMDE.togglePreview,
			className: "fa fa-eye no-disable",
			title: "Aperçu",
		},
    {
			name: "side-by-side",
			action: SimpleMDE.toggleSideBySide,
			className: "fa fa-columns no-disable no-mobile",
			title: "Aperçu temps-réel",
		},
    {
			name: "fullscreen",
			action: SimpleMDE.toggleFullScreen,
			className: "fa fa-arrows-alt no-disable no-mobile",
			title: "Plein écran",
		},
    "|",
    {
			name: "guide",
			action: "https://docs.framasoft.org/fr/mattermost/help/messaging/formatting-text.html",
			className: "fa fa-question-circle",
			title: "Aide",
		},

    ]
   });
simplemde.options.promptTexts = {"link" : "Adresse du lien", "image" : "Adresse de l'image"};
simplemde.value(document.querySelector('textarea[name=description]').defaultValue);
</script>

{% endblock %}
