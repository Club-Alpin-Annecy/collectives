{% extends 'base.html' %}

{% import 'macros.html' as macros with context %}

{% block additionalhead %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/event/event.css') }}">

  <link href="https://unpkg.com/tabulator-tables@4.5.1/dist/css/materialize/tabulator_materialize.min.css" rel="stylesheet">
  <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.5.1/dist/js/tabulator.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script>

  <script>
      var ajaxURL= '/api/user/{{user.id}}/events';
  </script>
  <script src="{{ url_for('static', filename='js/profile.js') }}"></script>
{% endblock %}

{% block header %}
<h1>{% block title %} {{user.full_name()}} {% endblock %}</h1>
{% endblock %}

{% block content %}
<div class="panel" id="eventdetail">
    <h3>{{user.full_name()}}</h3>

    {% if user.license_expiry_date %}
    <p>
        Licence de catégorie {{user.license_category}} expirant le {{format_date(user.license_expiry_date)}}.
    </p>
    {% endif %}

    <h4>Informations de contact</h4>
    <ul>
        <li><b>Email :</b> {{user.mail}}</li>
        <li><b>Téléphone :</b> {{user.phone}}</li>
        <li><b>En cas d'accident :</b> {{user.emergency_contact_name}} au {{user.emergency_contact_phone}}</li>
    </ul>
    {% if user == current_user %}
    <a class="button" href="{{url_for('root.update_user')}}">Modifier mes informations</a>
    {% elif current_user.is_admin() %}
    <a class="button" href="{{url_for('administration.manage_user', user_id=user.id)}}">Modifier l'utilisateur</a>
    {% endif %}

    <h4>Sorties à venir</h4>
    <div id="eventstable">
    </div>

    <h4>Sorties effectuées</h4>
    <div id="pasteventstable">
    </div>
</div>

{% endblock %}
