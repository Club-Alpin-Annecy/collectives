{% extends 'base.html' %}


{% import 'macros.html' as macros with context %}

{% block header %}
  {% block title %}Liste{% endblock %}
{% endblock %}



{% block additionalhead %}


  {# Tabulator: for tables#}
  <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.9.3/dist/js/tabulator.js"></script>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script>

  {# Autocomplete for leader lookup #}
  <script src="https://unpkg.com/js-autocomplete@1.0.4/auto-complete.min.js"></script>
  <link href="https://unpkg.com/js-autocomplete@1.0.4/auto-complete.css" rel="stylesheet">

  <script src="{{ url_for('static', filename='js/event/eventlist.js') }}"></script>
  <script src="{{ url_for('static', filename='js/tools.js') }}"></script>
  <script src="{{ url_for('static', filename='js/utils/autocomplete.js') }}"></script>

{% endblock %}


{% block scriptJsBody %}

  {# Script JS in body tag #}
  <script src="{{ url_for('static', filename='js/modal.js') }}"></script>
  <script src="{{ url_for('api.models_to_js') }}"></script>

{% endblock %}



{% block content %}

  <div class="panel">

    <h3><a href="{{ url_for('equipment.view_equipment')}}" class="link_path"> <span class="title_first_path">GESTION DU MATÉRIEL</span></a> 
      <a href="{{ url_for('equipment.view_equipment_type')}}" class="link_path"> <span class="title_second_path">/  MATÉRIEL</span> </a> 
    </h3>
    <div id="example-table"></div>
    <script>
      var ajaxURL= '/api/equipementType';

      //initialize table
      let table = new Tabulator("#example-table", {
        ajaxURL:ajaxURL,
        layout:"fitColumns",      //fit columns to width of table
        responsiveLayout:"hide",  //hide columns that dont fit on the table
        tooltips:true,            //show tool tips on cells
        addRowPos:"top",          //when adding a new row, add it to the top of the table
        history:true,             //allow undo and redo actions on the table
        pagination:"local",       //paginate the data
        paginationSize:7,         //allow 7 rows per page of data
        movableColumns:true,      //allow column order to be changed
        resizableRows:true,       //allow row order to be changed
        initialSort:[             //set the initial sort order of the data
            {column:"name", dir:"asc"},
        ],
        columns:[                 //define the table columns
          //{title:"id", field:"id", formatter:"number"},
          {title:"Name", headerFilter:"input",field:"name", formatter:"link", formatterParams:{urlField:"urlEquipmentTypeDetail"}},
          {title:"Photo", field:"pathImg", formatter:"image", formatterParams:{height: '7em'}},
          {title:"Prix", field:"price", formatter:"money"},
          {title:"Caution", field:"deposit", formatter:"money"},
        ],
         //create columns from data field names
      });
    </script>

    <h4>Type equipement</h4>

    <p class="button button-primary button-small button-open-modal">Ajouter</p>


    <div class="container_all_card">

      {% for anEquipmentType in listEquipementType %}
      
        <div class="container_one_card">
            {% if typeId != anEquipmentType.id %}



            <div class="container_card_img_info">

              <div class="container_card_img">
                <img src=" {{ 
                  url_for('static', filename='uploads/typeEquipmentImg/') + anEquipmentType.pathImg 
                  if anEquipmentType.pathImg else 
                 url_for('static', filename='img/icon/ionicon/md-images.svg') }}" alt="">
              </div>

              <div class="container_card_info">
                <p> {{ anEquipmentType.name }} </p>
                <p> <span class="type_info">Prix :</span> {{ anEquipmentType.price }} €</p>
                <p> <span class="type_info">Caution :</span> {{ anEquipmentType.deposit or "- "}} €</p>
              </div>

              
            </div>


            <div class="container_btn_edit">
              <a href="{{ url_for("equipment.detail_equipment_type",typeId=anEquipmentType.id)}}" class="button button-primary button-small">edit</a>

            </div>


            


              
            
              {% else %}
              {% with form=formEdit, route=url_for("equipment.detail_equipment_type",typeId=anEquipmentType.id) %}
                {% include "equipment/gestion/equipmentType/form.html" %}
              {% endwith %}
          
            {% endif %}

        </div>

      {% endfor %}
        
        


      

      
    

  </div>







  {% with form=formAjout, route=url_for('equipment.view_equipment_type'),
  includePath="equipment/gestion/equipmentType/form.html", titre="Ajouter un type d'équipement"%}
    {% include 'partials/modal.html' %}
  {% endwith %}

 


{% endblock %}